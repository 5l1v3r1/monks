# -*- Makefile -*-

ccflags-y := -std=gnu89 -g -Wall
ldflags-y := -T$(M)/linkerscript.ld

obj-m += procmon.o

procmon-y += 	main.o			\
				utils.o			\
				sct_hook.o		\
				syscalls/read.o

$(obj)/main.o: $(obj)/unistd_32.h

$(obj)/unistd_32.h: $(src)/unistd_32_hack.h FORCE
	@cpp $(c_flags) -E -dM <$< | grep -e '^#define __NR_' | sed -e 's/^#define __NR_/#define __NR32_/g' >$@
