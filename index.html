<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Procmon by alexandernst</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Procmon</h1>
        <p class="header">Procmon alternative for Linux</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/alexandernst/procmon/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/alexandernst/procmon/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/alexandernst/procmon">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/alexandernst">alexandernst</a></p>


      </header>
      <section>
        <h1>
<a name="what-is-procmon" class="anchor" href="#what-is-procmon"><span class="octicon octicon-link"></span></a>What is Procmon</h1>

<p>Procmon is a kernel module that hijacks sys calls and sends information about which
processes called which sys calls, with what arguments did they call them with, 
what was the return value, etc, and sends that information to a nice ncurses 
interface.</p>

<p>Said in another way, Procmon is like <code>strace</code>, but tracing all and every single
process from any user, at any level.</p>

<p>That's how it works:</p>

<p><img src="https://raw.github.com/alexandernst/procmon/screenshots/procmon.gif" alt="How it works"></p>

<h1>
<a name="setting-procmon" class="anchor" href="#setting-procmon"><span class="octicon octicon-link"></span></a>Setting Procmon</h1>

<p>Keep in mind that this is a WIP and you can end up with a totally frozen 
kernel! Do <em>NOT</em> run this in production machines. I'm <em>NOT</em> responsible
for any data loss or damage in any way.</p>

<p>In order to build this module you'll need some basic stuff (make, gcc), the 
headers of the kernel you're running on and ncurses library. Once you have all
those you just need to run <code>make</code> inside the root folder of the project.</p>

<p>Loading the module isn't any different from loading any other module. 
<code>insmod procmon.ko</code> for loading it and <code>rmmod procmon.ko</code> for 
unloading it.</p>

<p>To start the actual hijack process, once loaded the module, run 
<code>sysctl procmon.state=1</code>, then you'll probably want to run 
<code>./procmon-viewer</code> to see an actual output.</p>

<p>To stop it just run hit <code>Q</code>. To stop the module run <code>sysctl procmon.state=0</code>.</p>

<p>If your distro has <code>libkmod</code>, you can use procmon's viewer command line
switches instead to do all those actions (load/unload, start/stop).</p>

<p>Keep in mind that the module will protect your kernel while unloading. That 
means that if any process (both in userland and in the kernel itself) expected 
to call one of the hijacked syscalls, the module will wait those processes to 
call what they need to call. This may take from 1ms to days. If there's a really 
long delay, try killing/restarting some processes that may have scheduled a 
call. For example, the module won't unload until you press <code>Enter</code> on all 
consoles that had any activity while the module was loaded.</p>

<p>The UI is based on <code>ncurses</code>. Anyways, right now there is almost no functional
code, just a basic viewer.</p>

<p><img src="https://raw.github.com/alexandernst/procmon/screenshots/screenshot1.jpeg" alt="Screenshot"></p>

<h1>
<a name="why-procmon" class="anchor" href="#why-procmon"><span class="octicon octicon-link"></span></a>Why Procmon</h1>

<p>I'm completely aware of <code>kprobes</code>, <code>perf</code> and all other kernel debug 
systems/methods. Probably all of them work better than Procmon, but they have 
one disadvantage: they require you to recompile the kernel or they are not 
enabled by default in some distros.</p>

<p>Yet another reason: I have fun doing it! I don't seek for this project to be 
merged into mainline nor being used by every Linux user out there. I'm doing 
it for myself. Anyways, I'd be glad if it works for you too :)</p>

<p>On the other hand, Procmon will <code>just work</code>.
What this module does to <code>just work</code> is hijack/replace all 
(relevant/interesting) syscalls from the syscall table. While this is risky, 
it will allow you to have a similar tool to Procmon for Windows, without having
to recompile the kernel.</p>

<h1>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h1>

<p>Just send me patches, if they are ok I'll give you push access :)</p>

<p>About the editing, note that I'm using <code>TAB</code>s, so please keep it that way.</p>

<h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<p>The license is WTFPL (Do What The Fuck You Want To Public License), but keep
in mind it's good for both sides if you use this project, fix/add things and
push them back.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-27952342-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>